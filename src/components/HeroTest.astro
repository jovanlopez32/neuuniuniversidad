---
import PrimaryButton from './buttons/PrimaryButton.astro'
import SecondaryButton from './buttons/SecondaryButton.astro'
---

<!-- <section class="w-full min-h-screen relative grid grid-cols-1 md:grid-cols-2 gap-10 px-8">
    <div class="flex items-center justify-center text-pretty">
        <div class="max-w-2xl">
            <h1 class="text-3xl md:text-5xl font-extrabold mb-4">Mas que clases en linea, <span class="bg-clip-text text-transparent bg-[linear-gradient(to_right,theme(colors.nsecondary),theme(colors.nprimary),theme(colors.nprimary),theme(colors.nsecondary))] bg-[length:200%_auto] animate-gradient">un ecosistema virtual</span>.</h1>
            <p class="text-lg mb-6">Dentro de esta realidad digital, las lecciones en línea se transforman en un ecosistema educativo vibrante, donde se fusionan la tecnología, la imaginación y el aprendizaje sin fronteras.</p>

            <div class="flex gap-5">
                <PrimaryButton text="Empezar ahora" />
                <a href="#_" class="inline-flex items-center justify-center font-semibold duration-200 hover:text-nprimary focus:outline-none focus-visible:outline-gray-600">
                    Learn more   →
                  </a>
            </div>
        </div>
    </div>

    <div class="relative flex items-center justify-center px-8">
        Background
        <div class="size-1/2 rounded-full -z-20 bg-nprimary/40 blur-3xl absolute top-24 right-0"></div>
        <div class="size-1/2 rounded-full -z-20 bg-nsecondary/40 blur-3xl absolute bottom-0 left-0"></div>

        <div class="w-full h-96 max-w-2xl rounded-md">
            <iframe class="w-full h-full rounded-md" src="https://www.youtube.com/embed/vUBRTgZhVro?si=B2mKdD-jLXBwHw3i" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        </div>
    </div>


    

</section> -->

<div class="w-full min-h-screen grid grid-cols-1 place-content-center overflow-hidden" x-data="slider">
    
    <div class="transition-all duration-150 delay-300 ease-in-out">
        <div class="relative flex flex-col" x-ref="items">
           
            <template x-for="(item, index) in items" :key="index">
                <div
                    x-show="active === index"
                    x-transition:enter="transition ease-in-out duration-500 delay-200 order-first"
                    x-transition:enter-start="opacity-0 scale-105"
                    x-transition:enter-end="opacity-100 scale-100"
                    x-transition:leave="transition ease-in-out duration-300 absolute"
                    x-transition:leave-start="opacity-100 scale-100"
                    x-transition:leave-end="opacity-0 scale-95"
                >
                    
                    <section class="w-full min-h-screen relative grid grid-cols-1 lg:grid-cols-2 ">
                        <div class="flex items-center justify-center text-pretty">
                            <div class="px-8 max-w-2xl">
                                <h1 class="text-3xl md:text-5xl font-extrabold mb-4">Mas que clases en linea, <span class="bg-clip-text text-transparent bg-[linear-gradient(to_right,theme(colors.nsecondary),theme(colors.nprimary),theme(colors.nprimary),theme(colors.nsecondary))] bg-[length:200%_auto] animate-gradient">un ecosistema virtual</span>.</h1>
                                <p class="text-lg mb-6">Dentro de esta realidad digital, las lecciones en línea se transforman en un ecosistema educativo vibrante, donde se fusionan la tecnología, la imaginación y el aprendizaje sin fronteras.</p>
                    
                                <div class="flex gap-5 ">
                                    <PrimaryButton text="Empezar ahora" />
                                    <a href="#_" class="inline-flex items-center justify-center font-semibold duration-200 hover:text-nprimary focus:outline-none focus-visible:outline-gray-600">
                                        Learn more   →
                                      </a>
                                </div>
                            </div>
                        </div>
                    
                        <div class="relative">
                            <div class="size-1/2 rounded-full bg-nprimary/20 blur-3xl absolute top-52 right-0"></div>
                            <div class="size-1/2 rounded-full bg-nsecondary/10 blur-3xl absolute bottom-32 left-0"></div>
                        </div>
    
                    </section>

                    </div>
                </div>
            </template>
        </div>
    </div>

    
    <div class="absolute bottom-12 w-full ">

        <div class="w-full max-w-xl mx-auto  grid grid-cols-4 gap-4 ">
        
            <template x-for="(item, index) in items" :key="index">
                <button class="p-2 rounded focus:outline-none focus-visible:ring focus-visible:ring-indigo-300 group" @click="active = index">
                    <span class="text-center flex flex-col items-center" :class="active === index ? '' : 'opacity-50 group-hover:opacity-100 group-focus:opacity-100 transition-opacity'">
                        <span class="block relative w-full bg-neutral-400 h-1.5 rounded-full" role="progressbar" :aria-valuenow="active === index ? progress : 0" aria-valuemin="0" aria-valuemax="100">
                            <span class="absolute inset-0 bg-nprimary rounded-[inherit]" :style="`${active === index ? `width: ${progress}%` : 'width: 0%'}`"></span>
                        </span>
                    </span>
                </button>
            </template>
        </div>

    </div>
    
</div>

<script>
    document.addEventListener('alpine:init', () => {
        Alpine.data('slider', () => ({
            duration: 10000,
            active: 0,
            progress: 0,
            firstFrameTime: 0,
            items: [
                {
                    title: 'Esto es un titulo 1',
                    color_title: 'Principal',
                    text: 'ps-icon-01.svg',
                },
                {
                    title: 'Esto es un titulo 2',
                    color_title: 'Principal',
                    text: 'ps-icon-01.svg',
                },
                {
                    title: 'Esto es un titulo 3',
                    color_title: 'Principal',
                    text: 'ps-icon-01.svg',
                },
                {
                    title: 'Esto es un titulo 4',
                    color_title: 'Principal',
                    text: 'ps-icon-01.svg',
                },                                
            ],
            init() {
                this.startAnimation()
                this.$watch('active', callback => {
                    cancelAnimationFrame(this.frame)
                    this.startAnimation()
                })
            },
            startAnimation() {
                this.progress = 0
                this.$nextTick(() => {
                    this.heightFix()
                    this.firstFrameTime = performance.now()
                    this.frame = requestAnimationFrame(this.animate.bind(this))
                })
            },
            animate(now) {
                let timeFraction = (now - this.firstFrameTime) / this.duration
                if (timeFraction <= 1) {
                    this.progress = timeFraction * 100
                    this.frame = requestAnimationFrame(this.animate.bind(this))
                } else {
                    timeFraction = 1
                    this.active = (this.active + 1) % this.items.length
                }
            },
            heightFix() {
                this.$nextTick(() => {
                    this.$refs.items.parentElement.style.height = this.$refs.items.children[this.active + 1].clientHeight + 'px'
                })
            }                            
        }))
    })
</script>